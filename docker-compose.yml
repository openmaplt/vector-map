version: "2"

services:
  tegola:
    image: xor22h/tegola:v0.10.2
    ports: ["8080:8082"]
    links: ["db"]
    environment:
      PGHOST: db
    working_dir: /src
    entrypoint: /bin/sh -c "/src/generate_config.sh && /opt/tegola serve --config /src/config.toml"
    volumes:
      - ".:/src"

  db:
    image: postgis/postgis:13-3.0
    environment:
      POSTGRES_DBNAME: osm
      POSTGRES_USER: osm
      POSTGRES_PASSWORD: osm
    volumes:
      - ".:/src"
      - "/var/lib/postgresql"

  maputnik:
    image: maputnik/editor:latest
    ports: ["8888:8888"]

